$(document).ready(function(){state="run",protocol_params="direct",win=document.getElementsByTagName("iframe")[0].contentWindow,fr=document.getElementsByTagName("iframe")[0],fr.src.search("generator")>0&&(protocol_params="frame"),url=window.location.href+"params/params.json",window.setInterval(function(){try{"stop"!=state&&$.getJSON(url+"?t="+(new Date).getTime(),function(e){"frame"==protocol_params?win.postMessage(e,"*"):window.onmessage({data:e}),e.hasOwnProperty("state")&&(state=e.state)})}catch(e){console.error("Error get params:",e.message),state="stop"}},5e3)});