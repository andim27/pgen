function setAllTankPictWidth(){for(var t=$(window).width(),a=app.$data.g_pict_dimension[0],n=0;n<app.$data.g_pict_dimension.length;n++)t>app.$data.g_pict_dimension[n]&&(a=app.$data.g_pict_dimension[n]);return a}function calcToday(){var t=new Date;return t.toLocaleDateString()+" "+t.toLocaleTimeString()}function initToday(){jQuery("#datetimepicker").datetimepicker({format:"d.m.Y H:i"}),console.info("DateTime init....")}function initTank_top(){console.log("InitTank_top...."),draw_tank_top=SVG("tank_top").size(300,200),x1=50,y1=0,h=180,l=200,l_skos=20,otstup=20,h_vistup=20}function showViewTank_top(){kontur=[[x1,y1],[x1+l/2,y1],[x1+l/2+otstup,y1+otstup],[x1+l/2+2*otstup,y1+otstup],[x1+l/2+2*otstup,y1+otstup/2],[x1+l/2+3*otstup,y1+otstup/2],[x1+l/2+3*otstup,y1+otstup],[x1+l/2+4*otstup,y1+otstup],[x1+l/2+4*otstup,y1+h],[x1-otstup,y1+h],[x1-otstup,y1+otstup],[x1,y1]],tank_top=draw_tank_top.polyline([kontur]).fill("none").stroke({width:4})}function showFillTank_top(t){console.log("showFillTank_top "+t);var a=h/100*t,n=x1-otstup+4,e=y1+otstup+1+(h-a),i=l-8,o=a-otstup-1;tank_top_fill=draw_tank_top.rect(i,o).fill("green").move(n,e),console.log("tank_top_fill="+tank_top_fill),draw_tank_top.text(t.toString()+" %").move(x1+l/6,y1+2)}function initTank(){draw_tank=SVG("tank").size(300,300),tank_width=160,tank_h=200}function showViewTank(){tank_x1=0,tank_y1=0,draw_tank.rect(tank_width/2,tank_h/6).fill("none").stroke({width:4}).move(tank_x1+tank_width/4,tank_y1),draw_tank.rect(tank_width,tank_h).fill("none").radius(10).stroke({width:4}).move(tank_x1,tank_y1+tank_h/6)}function showFillTank(t){console.log("showFillTank "+t);var a=tank_h/6,n=tank_h/100*t,e=tank_x1+4,i=tank_y1+a+(tank_h-n)+1,o=tank_width-8,p=tank_y1+n-2;tank_fill=draw_tank.rect(o,p).fill("green").move(e,i),draw_tank.text(t.toString()+" %").move(tank_x1+tank_width/2.5,y1+tank_h/2)}function initAllTank(){console.log("InitAllTank..."),cur_pict_width=setAllTankPictWidth(),console.log("Set pict width:"+cur_pict_width);var t=document.getElementById("tank").getContext("2d"),a=document.getElementById("g_all_img");t.drawImage(a,0,0),initGPictKoord(),fillTank(40),fillBatarey(70)}function getMousePos(t,a){var n=t.getBoundingClientRect();return{x:a.clientX-n.left,y:a.clientY-n.top}}function clickOnEngine(t){var a=$("#tank").width()/2,n=$("#tank").width()-5,e=$("#tank").height()/2,i=$("#tank").height()-5;return t.x>a&&t.x<n&&t.y>e&&t.y<i}function drawEngine(t){var a=(document.getElementById("tank"),document.getElementById("tank").getContext("2d"));clearFill("engine");var n=new Image;n.src="images/motor_"+app.$data.cur_pict_width+"_"+t+".png",n.addEventListener("load",function(){a.drawImage(n,n.width,n.height),console.log("draw motor img....")},!1)}function initGPictKoord(){app.$data.g_pict.tank.x1=.02*$("#tank").width(),app.$data.g_pict.tank.y1=.12*$("#tank").height(),app.$data.g_pict.tank.width=.96*$("#tank").width(),app.$data.g_pict.tank.height=.15*$("#tank").height(),app.$data.g_pict.tank.text_x=.42*$("#tank").width(),app.$data.g_pict.tank.text_y=.19*$("#tank").height(),app.$data.g_pict.batarey.x1=.085*$("#tank").width(),app.$data.g_pict.batarey.y1=.45*$("#tank").height(),app.$data.g_pict.batarey.width=.33*$("#tank").width(),app.$data.g_pict.batarey.height=.46*$("#tank").height(),app.$data.g_pict.batarey.text_x=.15*$("#tank").width(),app.$data.g_pict.batarey.text_y=.65*$("#tank").height()}function clearFill(t){var a=document.getElementById("tank").getContext("2d");"tank"==t&&(a.fillStyle="white",a.fillRect(app.$data.g_pict.tank.x1-1,app.$data.g_pict.tank.y1-1,app.$data.g_pict.tank.width+1,app.$data.g_pict.tank.height)),"batarey"==t&&(a.fillStyle="white",a.fillRect(app.$data.g_pict.batarey.x1-1,app.$data.g_pict.batarey.y1,app.$data.g_pict.batarey.width+1,app.$data.g_pict.batarey.height)),"engine"==t&&(a.fillStyle="white",engine_x1=.46*$("#tank").width(),engine_y1=$("#tank").height()/2-.2*$("#tank").height(),engine_width=.52*$("#tank").width(),engine_hight=10+$("#tank").height()/2,a.fillRect(engine_x1,engine_y1,engine_width,engine_hight))}function fillTank(t){var a=document.getElementById("tank").getContext("2d");clearFill("tank"),a.fillStyle="white",a.fillStyle="#70AC36",x100=app.$data.g_pict.tank.x1,y100=app.$data.g_pict.tank.y1,y_ps=y100+(app.$data.g_pict.tank.height-app.$data.g_pict.tank.height*t/100),h_ps=t*app.$data.g_pict.tank.height/100,a.fillRect(x100,y_ps,app.$data.g_pict.tank.width,h_ps),a.fillStyle="black",a.font=app.$data.g_pict_font,a.fillText(t.toString()+" %",app.$data.g_pict.tank.text_x,app.$data.g_pict.tank.text_y)}function fillBatarey(t){var a=document.getElementById("tank").getContext("2d");clearFill("batarey"),a.fillStyle="#70AC36",x100=app.$data.g_pict.batarey.x1,y100=app.$data.g_pict.batarey.y1,y_ps=y100+(app.$data.g_pict.batarey.height-app.$data.g_pict.batarey.height*t/100),h_ps=t*app.$data.g_pict.batarey.height/100,a.fillRect(x100,y_ps,app.$data.g_pict.batarey.width,h_ps),a.fillStyle="black",a.font=app.$data.g_pict_font,a.fillText(t.toString()+" %",app.$data.g_pict.batarey.text_x,app.$data.g_pict.batarey.text_y)}$(document).ready(function(){app=new Vue({el:"#app",data:{menu:[{label:"Main",isActive:!0},{label:"Current state",isActive:!1},{label:"Statistics",isActive:!1},{label:"Setup",isActive:!1}],menuActiveIndex:0,power_str:"OFF",engine_str:"OFF",g_pict:{tank:{x1:0,y1:0},batarey:{x1:0,y1:0}},g_pict_dimension:[240,320,370,768],g_pict_font:"32px arial",cur_pict_width:320,generator_name:"Mountain Cabin",today:calcToday(),isControlActive:!1,motor_state:0,motor_state_str:"OFF",message:"Mountaine Cabine",tank_fuel_ps:100,tank_top_fuel_ps:100,engine_params:[["Current Load",.3,"kW"],["System Temperature",38,"C°"],["Engine Temperature",85,"C°"],["Next Maintenance",28,"day"]],fuel_params:[["Total kW*h consumed",.5,"kW"],["Total fuel consumed",18,"liter"],["Average kW*h per day",.5,"kW"],["Average fuel per day",1.8,"liter"]]},methods:{menuActive:function(t){$("#menu_modal").removeClass("is-active"),this.menuActiveIndex=t;for(var a=0;a<this.menu.length;a++)this.menu[a].isActive=a==t;2==t&&initCharts(),3==t&&initToday(),console.log(t)},btnMenuClickOpen:function(){$("#menu_modal").addClass("is-active")},btnMenuClickClose:function(){$("#menu_modal").removeClass("is-active")},btnFillTank_top:function(){alert(this.tank_top_fuel_ps),showFillTank_top(this.tank_top_fuel_ps)},btnFillRemove:function(){$("#"+tank_top_fill.attr("id")).remove()},btnMotorClick:function(){0==this.motor_state?(this.motor_state=1,this.motor_state_str="ON"):(this.motor_state=0,this.motor_state_str="OFF")},setPower:function(){"OFF"==this.power_str?this.power_str="ON":this.power_str="OFF",console.log("Power is:"+this.power_str)},saveControls:function(){alert("saved")}}}),console.log("Screen width:"+$(window).width()),initAllTank()});